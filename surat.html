<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aplikasi Surat Tugas BMKG</title>
  <link rel="icon" type="image/png" href="logo_bmkg.png">
  <link rel="shortcut icon" type="image/x-icon" href="logo_bmkg.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #1a4f72;
      --secondary: #2c6b9e;
      --accent: #f2c94c;
      --light: #f8f9fa;
      --dark: #343a40;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
      --bg-gradient: linear-gradient(135deg, #e6f0ff 0%, #c9e6ff 100%);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-gradient);
      margin: 0;
      padding: 30px;
      min-height: 100vh;
      color: #333;
    }
    
    .container {
      max-width: 2500px;
      margin: 20px auto;
      background: #fff;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.18);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .container:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.22);
    }
    
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      padding: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .header::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
      transform: rotate(30deg);
    }
    
    .header h1 {
      font-size: 32px;
      margin-bottom: 8px;
      position: relative;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
    }
    
    .header p {
      font-size: 17px;
      opacity: 0.9;
      position: relative;
      max-width: 600px;
      margin: 0 auto;
    }
    
    .header-icon {
      position: absolute;
      top: 25px;
      right: 25px;
      font-size: 38px;
      opacity: 0.25;
      transition: opacity 0.3s ease;
    }
    
    .header:hover .header-icon {
      opacity: 0.35;
    }
    
    .app-container {
      display: flex;
      min-height: 600px;
    }
    
    .form-section {
      flex: 1;
      padding: 35px;
      background: #f9fbfd;
      border-right: 1px solid #eaeaea;
    }
    
    .preview-section {
      flex: 1.3;
      padding: 35px;
      background: #fff;
      display: flex;
      flex-direction: column;
    }
    
    .section-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 25px;
      color: var(--primary);
      padding-bottom: 12px;
      border-bottom: 3px solid var(--primary);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .form-group {
      margin-bottom: 25px;
      position: relative;
    }
    
    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--primary);
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    label i {
      font-size: 14px;
      opacity: 0.8;
    }
    
    select, input, textarea {
      width: 100%;
      padding: 14px 18px;
      border: 1px solid #d6dde4;
      border-radius: 8px;
      font-family: 'Segoe UI', sans-serif;
      font-size: 16px;
      transition: all 0.3s;
      background: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
    }
    
    select:focus, input:focus, textarea:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 0 4px rgba(44, 107, 158, 0.15);
      transform: translateY(-2px);
    }
    
    textarea {
      resize: vertical;
      min-height: 120px;
    }
    
    .btn-group {
      display: flex;
      gap: 18px;
      margin-top: 35px;
    }
    
   button {
            flex: 1;
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
            z-index: -1;
        }

        button:hover::before {
            transform: translateX(100%);
        }

        button:active {
            transform: scale(0.96);
        }

        button.generate { 
            background: linear-gradient(135deg, var(--primary) 0%, #0d47a1 100%); 
            color: #fff; 
        }
        
        button.generate:hover { 
            transform: translateY(-6px);
            box-shadow: 0 12px 20px rgba(13, 71, 161, 0.25);
        }
        
        button.download { 
            background: linear-gradient(135deg, var(--success) 0%, #1b5e20 100%); 
            color: #fff; 
        }
        
        button.download:hover { 
            transform: translateY(-6px);
            box-shadow: 0 12px 20px rgba(27, 94, 32, 0.25);
        }
        
        button.print { 
            background: linear-gradient(135deg, var(--warning) 0%, #ff8f00 100%); 
            color: var(--dark); 
        }
        
        button.print:hover { 
            transform: translateY(-6px);
            box-shadow: 0 12px 20px rgba(255, 143, 0, 0.25);
        }

        .icon {
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        button:hover .icon {
            transform: scale(1.2);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(26, 115, 232, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(26, 115, 232, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(26, 115, 232, 0);
            }
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
    
    .surat-container {
      flex: 1;
      padding: 35px;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      background: #fdfdfd;
      font-family: "Times New Roman", serif;
      font-size: 16px;
      line-height: 1.6;
      overflow-y: auto;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.06);
      transition: box-shadow 0.3s ease;
    }
    
    .surat-container:hover {
      box-shadow: inset 0 0 15px rgba(0,0,0,0.08);
    }
    
    .surat-header {
      text-align: center;
      font-weight: bold;
      margin-bottom: 25px;
    }
    
    .surat-title {
        text-align: center;
        margin: 15px 0 0 0;
        font-size: 17px;
        font-weight: bold;
        line-height: 1;
        letter-spacing: normal;
    }
    
    .surat-title p {
        margin: 0px 0;
        line-height: 1;
        letter-spacing: normal;
    }

    .surat-content {
      text-align: justify;
    }
    
    .surat-footer {
      margin-top: 35px;
      text-align: center;
    }
    
    .ttd-area {
      margin-top: 90px;
      text-align: center;
    }
    
    .ttd-name {
      font-weight: bold;
      text-decoration: none;
      margin-top: 110px;
    }
    
    .pegawai-list {
      margin: 12px 0;
      padding-left: 0px;
    }
    
    .add-pegawai {
      background: var(--secondary);
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 12px;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    
    .add-pegawai:hover {
      background: #1f5a87;
      transform: translateY(-2px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.15);
    }
    
    .pegawai-item {
      background: #f1f6fc;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      position: relative;
      border-left: 4px solid var(--secondary);
      box-shadow: 0 3px 8px rgba(0,0,0,0.06);
      transition: transform 0.3s ease;
    }
    
    .pegawai-item:hover {
      transform: translateX(5px);
    }
    
    .remove-pegawai {
      position: absolute;
      right: 15px;
      top: 15px;
      color: var(--danger);
      cursor: pointer;
      background: #fff;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    
    .remove-pegawai:hover {
      transform: scale(1.1);
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
    }
    
    .manual-input {
      display: none;
      margin-top: 15px;
      padding: 20px;
      background: #f1f6fc;
      border-radius: 8px;
      border-left: 4px solid var(--accent);
    }
    
    .tabel-pegawai {
      border-collapse: collapse;
      margin-bottom: 12px;
      line-height: normal;
    }
    
    .tabel-pegawai td {
      padding: 4px 8px;
      vertical-align: top;
    }
    
    .tabel-pegawai .label {
      width: 160px;
    }
    
    .tabel-pegawai .titikdua {
      width: 10px;
      text-align: center;
    }

    /* Efek visual tambahan */
    .form-section, .preview-section {
      position: relative;
    }
    
    .form-section::after {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 1px;
      height: 100%;
      background: linear-gradient(to bottom, transparent, #dde4eb, transparent);
    }

    /* Navigation buttons */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      padding: 15px 25px;
      background: var(--gray-light);
      border-top: 1px solid var(--gray);
    }
    
    .nav-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-left: 10px;
      margin-right: 10px;
    }
    
    .nav-btn.back {
      background: var(--gray);
      color: var(--dark);
    }
    
    .nav-btn.back:hover {
      background: #ff5e00;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    
    .nav-btn.next {
      background: var(--primary);
      color: white;
    }
    
    .nav-btn.next:hover {
      background: #444445;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    
    /* Animasi untuk elemen form */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .form-group, .btn-group {
      animation: fadeIn 0.5s ease-out;
    }
    
    .form-group:nth-child(1) { animation-delay: 0.1s; }
    .form-group:nth-child(2) { animation-delay: 0.2s; }
    .form-group:nth-child(3) { animation-delay: 0.3s; }
    .form-group:nth-child(4) { animation-delay: 0.4s; }
    .form-group:nth-child(5) { animation-delay: 0.5s; }
    .btn-group { animation-delay: 0.6s; }
    
    /* Responsivitas */
    @media (max-width: 900px) {
      .app-container {
        flex-direction: column;
      }
      
      .form-section {
        border-right: none;
        border-bottom: 1px solid #eee;
      }
      
      .form-section::after {
        display: none;
      }

       .nav-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .nav-btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1><i class="fas fa-file-signature"></i> Aplikasi Surat Tugas BMKG</h1>
      <p>Badan Meteorologi, Klimatologi, dan Geofisika - Stasiun Klimatologi Jawa Tengah</p>
      <div class="header-icon">
        <i class="fas fa-stamp"></i>
      </div>
    </div>
    
    <div class="app-container">
      <div class="form-section">
        <div class="section-title"><i class="fas fa-edit"></i> Form Data Surat Tugas</div>
        
        <div class="form-group">
          <label for="penandatangan"><i class="fas fa-signature"></i> Penandatangan Surat:</label>
          <select id="penandatangan" onchange="toggleManualInput()">
            <option value="goeroeh">Goeroeh Tjiptanto, S.Stat, M.T.I</option>
            <option value="wahyu">Wahyu Prasetya Adi</option>
            <option value="lainnya">Lainnya</option>
          </select>
          <div id="manualInput" class="manual-input">
            <div class="form-group">
              <label for="manualNama"><i class="fas fa-user"></i> Nama:</label>
              <input type="text" id="manualNama" placeholder="Nama lengkap penandatangan">
            </div>
            <div class="form-group">
              <label for="manualNIP"><i class="fas fa-id-card"></i> NIP:</label>
              <input type="text" id="manualNIP" placeholder="NIP penandatangan">
            </div>
            <div class="form-group">
              <label for="manualPangkat"><i class="fas fa-award"></i> Pangkat/Golongan:</label>
              <select id="manualPangkat">
                <option value="">Pilih Pangkat/Golongan</option>
                <optgroup label="Juru">
                  <option value="Juru Muda / I a">Juru Muda / I a</option>
                  <option value="Juru Muda Tk. 1 / I b">Juru Muda Tk. 1 / I b</option>
                  <option value="Juru / I c">Juru / I c</option>
                  <option value="Juru Tk. 1 / I d">Juru Tk. 1 / I d</option>
                </optgroup>
                <optgroup label="Pengatur">
                  <option value="Pengatur Muda / II a">Pengatur Muda / II a</option>
                  <option value="Pengatur Muda Tk. 1 / II b">Pengatur Muda Tk. 1 / II b</option>
                  <option value="Pengatur / II c">Pengatur / II c</option>
                  <option value="Pengatur Tk. 1 / II d">Pengatur Tk. 1 / II d</option>
                </optgroup>
                <optgroup label="Penata">
                  <option value="Penata Muda / III a">Penata Muda / III a</option>
                  <option value="Penata Muda Tk. 1 / III b">Penata Muda Tk. 1 / III b</option>
                  <option value="Penata / III c">Penata / III c</option>
                  <option value="Penata Tk. 1 / III d">Penata Tk. 1 / III d</option>
                </optgroup>
                <optgroup label="Pembina">
                  <option value="Pembina / IV a">Pembina / IV a</option>
                  <option value="Pembina Tk. 1 / IV b">Pembina Tk. 1 / IV b</option>
                  <option value="Pembina Utama Muda / IV c">Pembina Utama Muda / IV c</option>
                  <option value="Pembina Utama Madya / IV d">Pembina Utama Madya / IV d</option>
                  <option value="Pembina Utama / IV e">Pembina Utama / IV e</option>
                </optgroup>
              </select>
            </div>
            <div class="form-group">
              <label for="manualJabatan"><i class="fas fa-briefcase"></i> Jabatan:</label>
              <input type="text" id="manualJabatan" placeholder="Jabatan penandatangan">
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="nomorSurat"><i class="fas fa-hashtag"></i> Nomor Surat:</label>
          <input type="text" id="nomorSurat" value="B/TU.01.00/001/KJTG/VIII/2025">
        </div>
        
        <div class="form-group">
          <label for="tanggalSurat"><i class="fas fa-calendar-alt"></i> Tanggal Surat:</label>
          <input type="date" id="tanggalSurat">
        </div>
        
        <div class="form-group">
          <label><i class="fas fa-users"></i> Pegawai yang Ditugaskan:</label>
          <div id="pegawaiList" class="pegawai-list">
            <div class="pegawai-item">
              <div class="form-group">
                <label for="pegawaiSelect1">Pilih Pegawai:</label>
                <select id="pegawaiSelect1" class="pegawai-select" onchange="togglePegawaiManualInput(this)">
                  <option value="">Pilih Pegawai</option>
                  <option value="goeroeh">Goeroeh Tjiptanto, S.Stat, M.T.I</option>
                  <option value="wahyu">Wahyu Prasetya Adi</option>
                  <option value="lainnya">Lainnya</option>
                </select>
              </div>
              <div id="pegawaiManualInput1" class="manual-input">
                <div class="form-group">
                  <label>Nama Pegawai:</label>
                  <input type="text" class="pegawai-nama" placeholder="Nama lengkap">
                </div>
                <div class="form-group">
                  <label>NIP:</label>
                  <input type="text" class="pegawai-nip" placeholder="Nomor Induk Pegawai">
                </div>
                <div class="form-group">
                  <label>Pangkat/Golongan:</label>
                  <select class="pegawai-pangkat">
                    <option value="">Pilih Pangkat/Golongan</option>
                    <optgroup label="Juru">
                      <option value="Juru Muda / I a">Juru Muda / I a</option>
                      <option value="Juru Muda Tk. 1 / I b">Juru Muda Tk. 1 / I b</option>
                      <option value="Juru / I c">Juru / I c</option>
                      <option value="Juru Tk. 1 / I d">Juru Tk. 1 / I d</option>
                    </optgroup>
                    <optgroup label="Pengatur">
                      <option value="Pengatur Muda / II a">Pengatur Muda / II a</option>
                      <option value="Pengatur Muda Tk. 1 / II b">Pengatur Muda Tk. 1 / II b</option>
                      <option value="Pengatur / II c">Pengatur / II c</option>
                      <option value="Pengatur Tk. 1 / II d">Pengatur Tk. 1 / II d</option>
                    </optgroup>
                    <optgroup label="Penata">
                      <option value="Penata Muda / III a">Penata Muda / III a</option>
                      <option value="Penata Muda Tk. 1 / III b">Penata Muda Tk. 1 / III b</option>
                      <option value="Penata / III c">Penata / III c</option>
                      <option value="Penata Tk. 1 / III d">Penata Tk. 1 / III d</option>
                    </optgroup>
                    <optgroup label="Pembina">
                      <option value="Pembina / IV a">Pembina / IV a</option>
                      <option value="Pembina Tk. 1 / IV b">Pembina Tk. 1 / IV b</option>
                      <option value="Pembina Utama Muda / IV c">Pembina Utama Muda / IV c</option>
                      <option value="Pembina Utama Madya / IV d">Pembina Utama Madya / IV d</option>
                      <option value="Pembina Utama / IV e">Pembina Utama / IV e</option>
                    </optgroup>
                  </select>
                </div>
                <div class="form-group">
                  <label>Jabatan:</label>
                  <input type="text" class="pegawai-jabatan" placeholder="Jabatan pegawai">
                </div>
              </div>
              <span class="remove-pegawai"><i class="fas fa-times"></i></span>
            </div>
          </div>
          <button type="button" class="add-pegawai" id="tambahPegawai"><i class="fas fa-plus"></i> Tambah Pegawai</button>
        </div>
        
        <div class="form-group">
          <label for="tugas"><i class="fas fa-tasks"></i> Tugas:</label>
          <textarea id="tugas" placeholder="Uraian tugas yang diberikan"></textarea>
        </div>
        
        <div class="form-group">
          <label for="lamaTugas"><i class="fas fa-clock"></i> Lama Tugas:</label>
          <input type="text" id="lamaTugas" placeholder="Contoh: 1 (satu) hari">
        </div>
        
        <div class="form-group">
          <label for="tanggalBerangkat"><i class="fas fa-plane-departure"></i> Tanggal Berangkat:</label>
          <input type="date" id="tanggalBerangkat">
        </div>
        
        <div class="form-group">
          <label for="lokasi"><i class="fas fa-map-marker-alt"></i> Lokasi Tugas:</label>
          <input type="text" id="lokasi" placeholder="Tempat pelaksanaan tugas">
        </div>
        
        <div class="form-group">
          <label for="sumberDana"><i class="fas fa-money-bill-wave"></i> Sumber Dana:</label>
          <input type="text" id="sumberDana" placeholder="Sumber pendanaan tugas">
        </div>
        
        <div class="btn-group">
          <button class="generate pulse" onclick="generateSurat()"><i class="fas fa-file-alt"></i> Buat Surat</button>
          
          <button class="print" onclick="printSurat()"><i class="fas fa-print"></i> Cetak</button>
        </div>
      </div>
      
      <div class="preview-section">
        <div class="section-title"><i class="fas fa-eye"></i> Preview Surat</div>
        <div class="surat-container" id="suratPreview">
          <!-- Preview akan di-generate oleh JavaScript -->
        </div>
      </div>
    </div>
    <div class="nav-buttons">
      <button class="nav-btn back" onclick="window.location.href='index.html'">
        <i class="fas fa-arrow-left"></i> Kembali
      </button>
      <button class="nav-btn next" onclick="window.location.href='tabel_srt.html'">
        Ke Surat Tugas Untuk Banyak Orang <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>

  <script>
    document.querySelectorAll('button').forEach(button => {
            // Efek ripple saat tombol diklik
            button.addEventListener('click', function(e) {
                const ripple = document.createElement('span');
                ripple.classList.add('ripple');
                
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
            
            // Efek hover untuk semua tombol
            button.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-6px)';
            });
            
            button.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    document.addEventListener('DOMContentLoaded', function() {
      // Set default dates
      const today = new Date();
      document.getElementById('tanggalSurat').valueAsDate = today;
      
      const nextWeek = new Date();
      nextWeek.setDate(today.getDate() + 7);
      document.getElementById('tanggalBerangkat').valueAsDate = nextWeek;
      
      // Add event listener for removing pegawai
      document.getElementById('pegawaiList').addEventListener('click', function(e) {
        if (e.target.closest('.remove-pegawai')) {
          e.target.closest('.pegawai-item').remove();
        }
      });
      
      // Add event listener for adding pegawai
      document.getElementById('tambahPegawai').addEventListener('click', function() {
        const pegawaiList = document.getElementById('pegawaiList');
        const newPegawai = document.createElement('div');
        newPegawai.className = 'pegawai-item';
        const pegawaiCount = pegawaiList.children.length + 1;
        
        newPegawai.innerHTML = `
          <div class="form-group">
            <label for="pegawaiSelect${pegawaiCount}">Pilih Pegawai:</label>
            <select id="pegawaiSelect${pegawaiCount}" class="pegawai-select" onchange="togglePegawaiManualInput(this)">
              <option value="">Pilih Pegawai</option>
              <option value="goeroeh">Goeroeh Tjiptanto, S.Stat, M.T.I</option>
              <option value="wahyu">Wahyu Prasetya Adi</option>
              <option value="lainnya">Lainnya</option>
            </select>
          </div>
          <div id="pegawaiManualInput${pegawaiCount}" class="manual-input">
            <div class="form-group">
              <label>Nama Pegawai:</label>
              <input type="text" class="pegawai-nama" placeholder="Nama lengkap">
            </div>
            <div class="form-group">
              <label>NIP:</label>
              <input type="text" class="pegawai-nip" placeholder="Nomor Induk Pegawai">
            </div>
            <div class="form-group">
              <label>Pangkat/Golongan:</label>
              <select class="pegawai-pangkat">
                <option value="">Pilih Pangkat/Golongan</option>
                <optgroup label="Juru">
                  <option value="Juru Muda / I a">Juru Muda / I a</option>
                  <option value="Juru Muda Tk. 1 / I b">Juru Muda Tk. 1 / I b</option>
                  <option value="Juru / I c">Juru / I c</option>
                  <option value="Juru Tk. 1 / I d">Juru Tk. 1 / I d</option>
                </optgroup>
                <optgroup label="Pengatur">
                  <option value="Pengatur Muda / II a">Pengatur Muda / II a</option>
                  <option value="Pengatur Muda Tk. 1 / II b">Pengatur Muda Tk. 1 / II b</option>
                  <option value="Pengatur / II c">Pengatur / II c</option>
                  <option value="Pengatur Tk. 1 / II d">Pengatur Tk. 1 / II d</option>
                </optgroup>
                <optgroup label="Penata">
                  <option value="Penata Muda / III a">Penata Muda / III a</option>
                  <option value="Penata Muda Tk. 1 / III b">Penata Muda Tk. 1 / III b</option>
                  <option value="Penata / III c">Penata / III c</option>
                  <option value="Penata Tk. 1 / III d">Penata Tk. 1 / III d</option>
                </optgroup>
                <optgroup label="Pembina">
                  <option value="Pembina / IV a">Pembina / IV a</option>
                  <option value="Pembina Tk. 1 / IV b">Pembina Tk. 1 / IV b</option>
                  <option value="Pembina Utama Muda / IV c">Pembina Utama Muda / IV c</option>
                  <option value="Pembina Utama Madya / IV d">Pembina Utama Madya / IV d</option>
                  <option value="Pembina Utama / IV e">Pembina Utama / IV e</option>
                </optgroup>
              </select>
            </div>
            <div class="form-group">
              <label>Jabatan:</label>
              <input type="text" class="pegawai-jabatan" placeholder="Jabatan pegawai">
            </div>
          </div>
          <span class="remove-pegawai"><i class="fas fa-times"></i></span>
        `;
        pegawaiList.appendChild(newPegawai);
      });
      
      // Generate initial preview
      generateSurat();
    });

    function toggleManualInput() {
      const penandatangan = document.getElementById('penandatangan').value;
      const manualInput = document.getElementById('manualInput');
      
      if (penandatangan === 'lainnya') {
        manualInput.style.display = 'block';
      } else {
        manualInput.style.display = 'none';
      }
    }

    function togglePegawaiManualInput(selectElement) {
      const pegawaiValue = selectElement.value;
      const pegawaiItem = selectElement.closest('.pegawai-item');
      const manualInput = pegawaiItem.querySelector('.manual-input');
      const namaInput = pegawaiItem.querySelector('.pegawai-nama');
      const nipInput = pegawaiItem.querySelector('.pegawai-nip');
      const pangkatSelect = pegawaiItem.querySelector('.pegawai-pangkat');
      const jabatanInput = pegawaiItem.querySelector('.pegawai-jabatan');
      
      if (pegawaiValue === 'lainnya') {
        manualInput.style.display = 'block';
      } else {
        manualInput.style.display = 'none';
        
        // Auto-fill data based on selection
        if (pegawaiValue === 'goeroeh') {
          namaInput.value = 'Goeroeh Tjiptanto, S.Stat, M.T.I';
          nipInput.value = '197101221994031001';
          pangkatSelect.value = 'Pembina Tk. 1 / IV b';
          jabatanInput.value = 'Kepala Stasiun Klimatologi Jawa Tengah';
        } else if (pegawaiValue === 'wahyu') {
          namaInput.value = 'Wahyu Prasetya Adi';
          nipInput.value = '197805142000121001';
          pangkatSelect.value = 'Pembina / IV a';
          jabatanInput.value = 'Kepala Sub-bagian Tata Usaha';
        }
      }
    }

    function generateSurat() {
      const penandatangan = document.getElementById('penandatangan').value;
      const nomorSurat = document.getElementById('nomorSurat').value;
      const tanggalSurat = new Date(document.getElementById('tanggalSurat').value);
      const tugas = document.getElementById('tugas').value || "Koordinasi Pelaksanaan PTB STMKG ke BKN Semarang";
      const lamaTugas = document.getElementById('lamaTugas').value || "1 (satu) hari";
      const tanggalBerangkat = new Date(document.getElementById('tanggalBerangkat').value);
      const lokasi = document.getElementById('lokasi').value || "Kantor BKN Semarang, Kec. Bergas, Kabupaten Semarang";
      const sumberDana = document.getElementById('sumberDana').value || "DIPA Stasiun Klimatologi Jawa Tengah TA.2025";
      
      // Format dates to Indonesian format
      const options = { day: 'numeric', month: 'long', year: 'numeric' };
      const formattedTanggalSurat = tanggalSurat.toLocaleDateString('id-ID', options);
      const formattedTanggalBerangkat = tanggalBerangkat.toLocaleDateString('id-ID', options);
      
      // Get penandatangan details
      let penandatanganNama, penandatanganNIP, penandatanganPangkat, penandatanganJabatan;
      
      if (penandatangan === 'goeroeh') {
        penandatanganNama = 'Goeroeh Tjiptanto, S.Stat, M.T.I';
        penandatanganNIP = '197101221994031001';
        penandatanganPangkat = 'Pembina Tk. I / IV b';
        penandatanganJabatan = 'Kepala Stasiun Klimatologi Jawa Tengah';
      } else if (penandatangan === 'wahyu') {
        penandatanganNama = 'Wahyu Prasetya Adi';
        penandatanganNIP = '197805142000121001';
        penandatanganPangkat = 'Pembina / IV a';
        penandatanganJabatan = 'Kepala Sub-bagian Tata Usaha';
      } else {
        // Manual input
        penandatanganNama = document.getElementById('manualNama').value || "Nama Penandatangan";
        penandatanganNIP = document.getElementById('manualNIP').value || "NIP Penandatangan";
        penandatanganPangkat = document.getElementById('manualPangkat').value || "Pangkat/Golongan";
        penandatanganJabatan = document.getElementById('manualJabatan').value || "Jabatan Penandatangan";
      }
      
      // Get pegawai data
      const pegawaiItems = document.querySelectorAll('.pegawai-item');
      let pegawaiHTML = '';
      
      pegawaiItems.forEach((item, index) => {
        const nama = item.querySelector('.pegawai-nama').value || 'Nama Pegawai';
        const nip = item.querySelector('.pegawai-nip').value || 'NIP';
        const pangkatSelect = item.querySelector('.pegawai-pangkat');
        const pangkat = pangkatSelect ? pangkatSelect.value : 'Pangkat/Golongan';
        const jabatan = item.querySelector('.pegawai-jabatan').value || 'Jabatan';
        
        pegawaiHTML += `
        <table style="border-collapse:collapse;margin-bottom:10px;width:100%;margin-left:0cm; font-size:12pt; line-height:1.2; table-layout:fixed;">
          <tr>
            <td style="width:160px; vertical-align:top; white-space:nowrap;">Nama</td>
            <td style="width:10px; vertical-align:top; text-align:center;">:</td>
            <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${nama}</td>
          </tr>
          <tr>
            <td style="width:160px; vertical-align:top; white-space:nowrap;">NIP</td>
            <td style="width:10px; vertical-align:top; text-align:center;">:</td>
            <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${nip}</td>
          </tr>
          <tr>
            <td style="width:160px; vertical-align:top; white-space:nowrap;">Pangkat/Golongan</td>
            <td style="width:10px; vertical-align:top; text-align:center;">:</td>
            <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${pangkat}</td>
          </tr>
          <tr>
            <td style="width:160px; vertical-align:top; white-space:nowrap;">Jabatan</td>
            <td style="width:10px; vertical-align:top; text-align:center;">:</td>
            <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${jabatan}</td>
          </tr>
          <tr>
            <td style="width:160px; vertical-align:top; white-space:nowrap;">Unit Organisasi</td>
            <td style="width:10px; vertical-align:top; text-align:center;">:</td>
            <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">Stasiun Klimatologi Jawa Tengah</td>
          </tr>
        </table>
      `;
      });
      
      // Generate the surat content
      const suratContent = `  
        <div>
          <table style="width:100%; border-collapse:collapse;">
            <tr>
              <!-- Logo -->
              <td style="width:100px; text-align:center; vertical-align:middle;">
                <img src="logo_bmkg.png" width="0">
              </td>
            </tr>
          </table>
        </div>
  <div style="font-family:'Times New Roman',serif;font-size:12pt;line-height:1.2; padding-left:2cm; padding-right:1cm; ">
      <!-- Judul -->
      <div style="text-align:center;font-weight:bold;">
        <div style="text-transform:uppercase;">SURAT TUGAS</div>
        <div style="margin-top:0px;">NOMOR : ${nomorSurat}</div>
      </div>
      <br>
      <!-- Pembuka -->
      <p style="text-align:justify;text-indent:0cm;margin:0; margin-bottom: 5px">
        Yang bertanda tangan di bawah ini :
      </p>

      <!-- Identitas Penandatangan -->
      <table style="border-collapse:collapse;margin-bottom:10px;width:100%;margin-left:0cm; table-layout:fixed;">
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Nama</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${penandatanganNama}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">NIP</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${penandatanganNIP}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Pangkat/Golongan</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${penandatanganPangkat}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Jabatan</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">${penandatanganJabatan}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Unit Organisasi</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal; text-indent:0px;">Stasiun Klimatologi Jawa Tengah</td>
        </tr>
      </table>
      

      <!-- Tugas -->
      <p style="text-align:justify;text-indent:0cm;margin:0; margin-top: 20px; margin-bottom: 6.5px;">
        Dengan ini memberikan tugas kepada :
      </p>
      ${pegawaiHTML}

      <p style="text-align:justify;text-indent:0cm;margin:0; margin-top: 20px;margin-bottom: 5px;">
        Untuk melaksanakan :
      </p>

      <table style="border-collapse:collapse;margin-bottom:10px;width:100%;margin-left:0cm; line-height:1.2; table-layout:fixed;">
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Tugas</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal;">${tugas}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Selama</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal;">${lamaTugas}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Lokasi</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal;">${lokasi}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Tanggal Berangkat</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal;">${formattedTanggalBerangkat}</td>
        </tr>
        <tr>
          <td style="width:160px; vertical-align:top; white-space:nowrap;">Sumber Dana</td>
          <td style="width:10px; vertical-align:top; text-align:center;">:</td>
          <td style="vertical-align:top; word-wrap:break-word; overflow-wrap:break-word; white-space:normal;">${sumberDana}</td>
        </tr>
      </table>

      <!-- Penutup -->
      <p style="text-align:justify;text-indent:0px;margin:0; margin-top: 20px;">
        Demikian, untuk dilaksanakan sebagaimana mestinya.
      </p>

      <!-- Tanda tangan -->
      <div style="margin-top:30px;margin-right:0cm; margin-left:45%; ">
        <p>Semarang, ${formattedTanggalSurat}<br>${penandatanganJabatan},</p>
      </div>

      <div style="margin-top:120px; margin-left:45%;">
        <div>${penandatanganNama}</div>
      </div>
    </div>
  `;
      
      // Update the preview
      document.getElementById('suratPreview').innerHTML = suratContent;
    }


 function printSurat() {
  const preview = document.getElementById("suratPreview").innerHTML;
  // Tentukan ukuran jendela baru
const newWidth = 1000; // Lebar baru (lebih besar)
const newHeight = 700; // Tinggi baru

// Hitung posisi tengah layar
// Mendapatkan lebar dan tinggi layar (atau layar kerja, tergantung peramban)
const screenLeft = window.screenLeft || window.screenX;
const screenTop = window.screenTop || window.screenY;
const screenWidth = window.innerWidth || document.documentElement.clientWidth || screen.width;
const screenHeight = window.innerHeight || document.documentElement.clientHeight || screen.height;

// Posisi X (Horizontal)
const left = ((screenWidth / 2) - (newWidth / 2)) + screenLeft;
// Posisi Y (Vertikal)
const top = ((screenHeight / 2) - (newHeight / 2)) + screenTop;

// Buat string fitur untuk window.open
const features = `height=${newHeight},width=${newWidth},left=${left},top=${top}`;

// Buka jendela baru
const w = window.open('', 'PopUpJendelaBaru', features);
  w.document.write(`
    <html>
      <head>
        <title>Surat Tugas</title>
        <style>
          @page { margin-top: 0;
            margin-bottom: 2cm;
            margin-left: 0cm;
            margin-right: 0cm;
          }
          body { font-family:'Times New Roman',
          serif; font-size:12pt; 
          line-height:1.2; 
          -webkit-print-color-adjust: exact !important; 
          print-color-adjust: exact !important;
           } p { text-indent:0px; margin:0 0 0px 0; } table { border-collapse:collapse; width:71%; margin-bottom:10px; } 
            td { padding:0.5px 0px; vertical-align:top; }
        </style>
      </head>
      <body>
       <div style="background-color:rgb(150,150,150); 
            padding:17px; 
            color:black; 
            margin-bottom:0; 
            position:relative;
            border-bottom:0.3px solid black;">

            <!-- Logo -->
            <img src="logo_bmkg.png" width="65" 
                style="position:absolute; left:50px; top:40%; transform:translateY(-40%); margin-left:25px;">

            <!-- Teks Header -->
            <div style="text-align:center;margin-left:60px;">
              <div style="font-size:14pt; font-weight:bold;">BADAN METEOROLOGI, KLIMATOLOGI, DAN GEOFISIKA</div>
              <div style="font-size:14pt; font-weight:bold;">STASIUN KLIMATOLOGI JAWA TENGAH</div>
              <div style="font-size:12pt;">Jl. Siliwangi No. 291 Semarang 50145 Telp. 024-7609016 Fax. 024-7612394</div>
              <div style="font-size:12pt;">
                    Email: <a style="color:rgb(0, 117, 255); text-decoration:underline;">staklim.jateng@bmkg.go.id</a> | 
                    Website: <a style="color:rgb(0, 117, 255); text-decoration:underline;">www.bmkg.go.id</a>
                  </div>

            </div>
          </div>

          <!-- Garis bawah tebal -->
          <hr style="border:2px solid black; margin:1.2px 0 15px 0;">

          
        <div style="margin-left:0.5cm;">
        ${preview}</div>
      </body>
    </html>
  `);
  w.document.close();
  w.print();
}
  </script>
</body>
</html>
